%%%%%%%%%%%%%%%%%%%
% Author: Lige
% Date: 2022.2.10
% Description:
%    The shortcut will regenerate C code whether the current opened simulink file is modified or not.
%%%%%%%%%%%%%%%%%%%disp(' ')
disp(' ')
disp(' ')
disp('***************************************************************************************************')
disp('*                                                                                                 *')
disp('*                                     Code Generate                                               *')
disp('*                                                                                                 *')
disp('***************************************************************************************************')

if(~isempty(bdroot))
    %delete slprj folder
    try
        rmdir slprj\ s
        disp('***************************************************************************************************')
        disp('Delete slprj fold!')
    catch
    end
    %delete build folder of the current opened simulink model
    folder_name = [bdroot '*'];
    try
        rmdir(folder_name,'s')
        disp('***************************************************************************************************')
        disp('Delete folder of code generation of the model!')
    catch
    end
    %delete temp file of the current opened simulink model
    try 
        delete(['*.slxc'])
        disp('***************************************************************************************************')
        disp('Delete the temp file of the model!')
    catch
    end
    clear folder_name;
    try
        disp('***************************************************************************************************')
        disp(['Model Name:   ' bdroot])
        disp('***************************************************************************************************')
        disp('Start code genration')
        slbuild(bdroot)
        disp('***************************************************************************************************')
        disp('Completed!')
        disp('***************************************************************************************************')
    catch
        disp('***************************************************************************************************')
        disp('Failure!')
        disp('***************************************************************************************************')
    end
else
    disp('***************************************************************************************************')
    disp('No opened model')
    disp('***************************************************************************************************')
end
